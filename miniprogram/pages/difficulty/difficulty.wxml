<!-- ÂºïÂÖ•ÂõæÊ†áÂ≠ó‰Ωì -->
<view class="iconfont-container">
  <text class="iconfont icon-edit"></text>
  <text class="iconfont icon-right"></text>
</view>

<view class="container {{isBaseArt ? 'base-art' : ''}}">
  <view class="header" style="margin-bottom: 5rpx; padding-bottom: 5rpx;">
    <image class="art-icon" src="{{level.icon || art.icon}}" mode="aspectFill"></image>
    <view class="title-container">
      <view class="title">{{level.name}}</view>
      <view class="subtitle">{{art.name}}</view>
    </view>
  </view>
  
  <view class="level-list" style="padding-top: 5rpx;">
    <view class="level-item {{index === 0 ? 'fade-in' : ''}} {{item.checked ? 'checked' : ''}}" 
          wx:for="{{difficulties}}" 
          wx:key="id"
          style="animation-delay: {{index * 0.1}}s"
          data-index="{{index}}"
          bindtap="showEditModal">
      <view class="level-content">
        <view class="level-name">
          {{item.name}}
          <!-- Âü∫Á°ÄÂä®‰ΩúÁöÑÂÄíÁ´ãÊíëÁâπÊÆäÂä®‰Ωú -->
          <text class="level-details" wx:if="{{isBaseArt && art.id === 6 && (level.id === 1 || level.id === 2 || level.id === 3)}}">
            <text wx:if="{{item.time > 0}}">{{item.time}}Áßí</text>
          </text>
          <!-- Âü∫Á°ÄÂä®‰ΩúÁöÑÂÖ∂‰ªñÂä®‰Ωú -->
          <text class="level-details" wx:elif="{{isBaseArt && !(art.id === 6 && (level.id === 1 || level.id === 2 || level.id === 3))}}">
            <text wx:if="{{item.sets > 0}}">{{item.sets}}ÁªÑ</text>
            <text wx:if="{{item.reps > 0}}">{{item.reps}}Ê¨°</text>
          </text>
          <!-- Ëá™ÂÆö‰πâÈöæÂ∫¶ -->
          <text class="level-details" wx:else>
            <text wx:if="{{item.time > 0}}">{{item.time}}Áßí</text>
            <text wx:elif="{{item.sets > 0 || item.reps > 0}}">
              <text wx:if="{{item.sets > 0}}">{{item.sets}}ÁªÑ</text>
              <text wx:if="{{item.reps > 0}}">{{item.reps}}Ê¨°</text>
            </text>
          </text>
        </view>
      </view>
      <view class="action-btn delete" catchtap="deleteDifficulty" data-index="{{index}}" wx:if="{{!isBaseArt}}">
        <text class="action-icon">√ó</text>
      </view>
      <view class="checkbox-wrapper" catchtap="toggleCheck" data-index="{{index}}">
        <view class="checkbox {{item.checked ? 'checked' : ''}}">
          <text class="check-icon" wx:if="{{item.checked}}">‚úì</text>
        </view>
      </view>
    </view>
  </view>

  <!-- Êñ∞Â¢ûÈöæÂ∫¶ÊåâÈíÆ -->
  <view class="add-difficulty-btn" bindtap="showAddDifficultyModal" wx:if="{{!isBaseArt}}">
    <text class="con-add">+</text>
    <text class="add-text">Ê∑ªÂä†ÈöæÂ∫¶</text>
  </view>

  <!-- ÂºÄÂßãËÆ≠ÁªÉÊåâÈíÆ -->
  <view class="start-training-btn {{isBaseArt ? 'base-art' : ''}} {{hasSelectedDifficulty ? 'active' : 'disabled'}}" bindtap="startTraining">
    <image  wx:if="{{hasSelectedDifficulty}}"  class="start-training-btn-icon" src="/images/caret-right-white.svg" alt=""/>
    <image wx:else  class="start-training-btn-icon" src="/images/caret-right.svg" alt=""/>
    <text>ÂºÄÂßãËÆ≠ÁªÉ</text>
  </view>

  <!-- ËÆæÁΩÆÂºπÁ™ó -->
  <view class="modal {{showModal ? 'show' : ''}}" wx:if="{{showModal}}">
    <view class="modal-mask" bindtap="hideModal"></view>
    <view class="modal-content">
      <view class="modal-header">
        <text class="modal-title">{{editDifficulty.name}}</text>
        <view class="close-button" bindtap="hideModal">√ó</view>
      </view>
      <view class="modal-body">
        <view class="setting-section">
          <view class="setting-title">ÂèØË∞ÉÊï¥ÂèÇÊï∞</view>
          
          <!-- ÈùûÂü∫Á°ÄÂä®‰Ωú -->
          <block wx:if="{{!isBaseArt}}">
            <!-- ÁªÑÊï∞ÂíåÊ¨°Êï∞ËÆæÁΩÆ -->
            <view class="setting-item">
              <view class="setting-label">
                <text class="setting-icon">üìä</text>
                <text>ÁªÑÊï∞</text>
              </view>
              <view class="setting-input">
                <input class="input" 
                      type="number" 
                      value="{{editDifficulty.sets}}"
                      bindinput="onSetsInput"/>
                <text class="unit">ÁªÑ</text>
              </view>
            </view>

            <view class="setting-item">
              <view class="setting-label">
                <text class="setting-icon">üîÑ</text>
                <text>Ê¨°Êï∞</text>
              </view>
              <view class="setting-input">
                <input class="input" 
                      type="number" 
                      value="{{editDifficulty.reps}}"
                      bindinput="onRepsInput"/>
                <text class="unit">Ê¨°</text>
              </view>
            </view>
          
            <!-- Ê¨°Êï∞Èó¥ÈöîÂíåÁªÑÈó¥‰ºëÊÅØ -->
          <view class="setting-item">
            <view class="setting-label">
              <text class="setting-icon">‚è±Ô∏è</text>
              <text>Ê¨°Êï∞Èó¥Èöî</text>
            </view>
            <view class="setting-input">
              <input class="input" 
                    type="number" 
                    value="{{editDifficulty.interval}}"
                    bindinput="onIntervalInput"/>
              <text class="unit">Áßí</text>
            </view>
          </view>
          
          <view class="setting-item">
            <view class="setting-label">
              <text class="setting-icon">‚è∞</text>
              <text>ÁªÑÈó¥‰ºëÊÅØ</text>
            </view>
            <view class="setting-input">
              <input class="input" 
                    type="number" 
                    value="{{editDifficulty.rest}}"
                    bindinput="onRestInput"/>
              <text class="unit">Áßí</text>
            </view>
          </view>
          
            <!-- Êó∂Èó¥ËÆæÁΩÆ -->
            <view class="setting-item">
              <view class="setting-label">
                <text class="setting-icon">‚è≥</text>
                <text>Êó∂Èó¥</text>
              </view>
              <view class="setting-input">
                <input class="input" 
                      type="number" 
                      value="{{editDifficulty.time}}"
                      bindinput="onTimeInput"/>
                <text class="unit">Áßí</text>
              </view>
            </view>
          </block>

          <!-- Âü∫Á°ÄÂä®‰Ωú -->
          <block wx:else>
            <!-- Ëá™Áî±ÈöæÂ∫¶ -->
            <block wx:if="{{editIndex === 3}}">
              <!-- ÂÄíÁ´ãÊíëÁöÑÁâπÊÆäÂä®‰Ωú -->
              <block wx:if="{{art.id === 6 && (level.id === 1 || level.id === 2 || level.id === 3)}}">
                <!-- Âè™ÊòæÁ§∫Êó∂Èó¥ÂíåËØ≠Èü≥Á±ªÂûã -->
                <view class="setting-item">
                  <view class="setting-label">
                    <text class="setting-icon">‚è≥</text>
                    <text>Êó∂Èó¥</text>
                  </view>
                  <view class="setting-input">
                    <input class="input" 
                          type="number" 
                          value="{{editDifficulty.time}}"
                          bindinput="onTimeInput"/>
                    <text class="unit">Áßí</text>
                  </view>
                </view>
              </block>
              <!-- ÂÖ∂‰ªñÂü∫Á°ÄÂä®‰ΩúÁöÑËá™Áî±ÈöæÂ∫¶ -->
              <block wx:else>
                <view class="setting-item">
                  <view class="setting-label">
                    <text class="setting-icon">üìä</text>
                    <text>ÁªÑÊï∞</text>
                  </view>
                  <view class="setting-input">
                    <input class="input" 
                          type="number" 
                          value="{{editDifficulty.sets}}"
                          bindinput="onSetsInput"/>
                    <text class="unit">ÁªÑ</text>
                  </view>
                </view>

                <view class="setting-item">
                  <view class="setting-label">
                    <text class="setting-icon">üîÑ</text>
                    <text>Ê¨°Êï∞</text>
                  </view>
                  <view class="setting-input">
                    <input class="input" 
                          type="number" 
                          value="{{editDifficulty.reps}}"
                          bindinput="onRepsInput"/>
                    <text class="unit">Ê¨°</text>
                  </view>
                </view>

                <view class="setting-item">
                  <view class="setting-label">
                    <text class="setting-icon">‚è±Ô∏è</text>
                    <text>Ê¨°Êï∞Èó¥Èöî</text>
                  </view>
                  <view class="setting-input">
                    <input class="input" 
                          type="number" 
                          value="{{editDifficulty.interval}}"
                          bindinput="onIntervalInput"/>
                    <text class="unit">Áßí</text>
                  </view>
                </view>
                
                <view class="setting-item">
                  <view class="setting-label">
                    <text class="setting-icon">‚è∞</text>
                    <text>ÁªÑÈó¥‰ºëÊÅØ</text>
                  </view>
                  <view class="setting-input">
                    <input class="input" 
                          type="number" 
                          value="{{editDifficulty.rest}}"
                          bindinput="onRestInput"/>
                    <text class="unit">Áßí</text>
                  </view>
                </view>
              </block>
            </block>

            <!-- Âü∫Á°ÄÂä®‰ΩúÁöÑÂàùÁ∫ß„ÄÅ‰∏≠Á∫ß„ÄÅÈ´òÁ∫ßÈöæÂ∫¶ -->
            <block wx:else>
              <!-- ÂÄíÁ´ãÊíëÁöÑÁâπÊÆäÂä®‰Ωú -->
              <block wx:if="{{art.id === 6 && (level.id === 1 || level.id === 2 || level.id === 3)}}">
                <!-- Âè™ÊòæÁ§∫ËØ≠Èü≥Á±ªÂûã -->
              </block>
              <!-- ÂÖ∂‰ªñÂü∫Á°ÄÂä®‰Ωú -->
              <block wx:else>
                <view class="setting-item">
                  <view class="setting-label">
                    <text class="setting-icon">‚è±Ô∏è</text>
                    <text>Ê¨°Êï∞Èó¥Èöî</text>
                  </view>
                  <view class="setting-input">
                    <input class="input" 
                          type="number" 
                          value="{{editDifficulty.interval}}"
                          bindinput="onIntervalInput"/>
                    <text class="unit">Áßí</text>
                  </view>
                </view>
                
                <view class="setting-item">
                  <view class="setting-label">
                    <text class="setting-icon">‚è∞</text>
                    <text>ÁªÑÈó¥‰ºëÊÅØ</text>
                  </view>
                  <view class="setting-input">
                    <input class="input" 
                          type="number" 
                          value="{{editDifficulty.rest}}"
                          bindinput="onRestInput"/>
                    <text class="unit">Áßí</text>
                  </view>
                </view>
              </block>
            </block>
          </block>

          <!-- ËØ≠Èü≥Á±ªÂûãËÆæÁΩÆÔºàÊâÄÊúâÊÉÖÂÜµÈÉΩÊòæÁ§∫Ôºâ -->
          <view class="setting-item voice-setting">
            <view class="voice-options">
              <view class="voice-option {{editDifficulty.voiceType === 'system' ? 'active' : ''}}" 
                    bindtap="onVoiceTypeSelect" 
                    data-type="system">
                <view class="voice-content">
                  <text class="voice-icon">üîä</text>
                  <view class="voice-info">
                    <text class="voice-title">Á≥ªÁªüÈü≥</text>
                  </view>
                </view>
                <view class="voice-check"></view>
              </view>
              <view class="voice-option {{editDifficulty.voiceType === 'human' ? 'active' : ''}}" 
                    bindtap="onVoiceTypeSelect" 
                    data-type="human">
                <view class="voice-content">
                  <text class="voice-icon">üë§</text>
                  <view class="voice-info">
                    <text class="voice-title">‰∫∫Â£∞</text>
                  </view>
                </view>
                <view class="voice-check"></view>
              </view>
            </view>
          </view>
        </view>
      </view>
      <view class="modal-footer">
        <button class="cancel-button" bindtap="hideModal">ÂèñÊ∂à</button>
        <button class="confirm-button" bindtap="saveSettings">Á°ÆÂÆö</button>
      </view>
    </view>
  </view>

  <!-- Êñ∞Â¢ûÈöæÂ∫¶ÂºπÁ™ó -->
  <view class="modal {{showAddModal ? 'show' : ''}}">
    <view class="modal-mask" bindtap="hideAddModal"></view>
    <view class="modal-content">
      <view class="modal-header">
        <text class="modal-title">Êñ∞Â¢ûÈöæÂ∫¶</text>
        <view class="close-button" bindtap="hideAddModal">√ó</view>
      </view>
      <view class="modal-body">
        <view class="setting-section">
          <view class="setting-title">ÈöæÂ∫¶‰ø°ÊÅØ</view>
          
          <view class="setting-item">
            <view class="setting-label">
              <text class="setting-icon">üìù</text>
              <text>ÈöæÂ∫¶ÂêçÁß∞</text>
            </view>
            <view class="setting-input">
              <input class="input" 
                    type="text" 
                    value="{{newDifficulty.name}}"
                    bindinput="onNewNameInput"/>
              <text class="unit empty-unit"> </text>
            </view>
          </view>

          <view class="setting-item">
            <view class="setting-label">
              <text class="setting-icon">üìä</text>
              <text>ÁªÑÊï∞</text>
            </view>
            <view class="setting-input">
              <input class="input" 
                    type="number" 
                    value="{{newDifficulty.sets}}"
                    bindinput="onNewSetsInput"
                    bindblur="onNewSetsBlur"/>
              <text class="unit">ÁªÑ</text>
            </view>
          </view>

          <view class="setting-item">
            <view class="setting-label">
              <text class="setting-icon">üîÑ</text>
              <text>Ê¨°Êï∞</text>
            </view>
            <view class="setting-input">
              <input class="input" 
                    type="number" 
                    value="{{newDifficulty.reps}}"
                    bindinput="onNewRepsInput"/>
              <text class="unit">Ê¨°</text>
            </view>
          </view>
          
          <view class="setting-item">
            <view class="setting-label">
              <text class="setting-icon">‚è±Ô∏è</text>
              <text>Ê¨°Êï∞Èó¥Èöî</text>
            </view>
            <view class="setting-input">
              <input class="input" 
                    type="number" 
                    value="{{newDifficulty.interval}}"
                    bindinput="onNewIntervalInput"/>
              <text class="unit">Áßí</text>
            </view>
          </view>
          
          <view class="setting-item">
            <view class="setting-label">
              <text class="setting-icon">‚è∞</text>
              <text>ÁªÑÈó¥‰ºëÊÅØ</text>
            </view>
            <view class="setting-input">
              <input class="input" 
                    type="number" 
                    value="{{newDifficulty.rest}}"
                    bindinput="onNewRestInput"/>
              <text class="unit">Áßí</text>
            </view>
          </view>
          
          <!-- Êó∂Èó¥ËÆæÁΩÆ -->
          <view class="setting-item">
            <view class="setting-label">
              <text class="setting-icon">‚è≥</text>
              <text>Êó∂Èó¥</text>
            </view>
            <view class="setting-input">
              <input class="input" 
                    type="number" 
                    value="{{newDifficulty.time}}"
                    bindinput="onNewTimeInput"/>
              <text class="unit">Áßí</text>
            </view>
          </view>
          
          <view class="setting-item voice-setting">
            <view class="voice-options">
              <view class="voice-option {{newDifficulty.voiceType === 'system' ? 'active' : ''}}" 
                    bindtap="onNewVoiceTypeSelect" 
                    data-type="system">
                <view class="voice-content">
                  <text class="voice-icon">üîä</text>
                  <view class="voice-info">
                    <text class="voice-title">Á≥ªÁªüÈü≥</text>
                  </view>
                </view>
                <view class="voice-check"></view>
              </view>
              <view class="voice-option {{newDifficulty.voiceType === 'human' ? 'active' : ''}}" 
                    bindtap="onNewVoiceTypeSelect" 
                    data-type="human">
                <view class="voice-content">
                  <text class="voice-icon">üë§</text>
                  <view class="voice-info">
                    <text class="voice-title">‰∫∫Â£∞</text>
                  </view>
                </view>
                <view class="voice-check"></view>
              </view>
            </view>
          </view>
        </view>
      </view>
      <view class="modal-footer">
        <button class="cancel-button" bindtap="hideAddModal">ÂèñÊ∂à</button>
        <button class="confirm-button" bindtap="saveNewDifficulty">Á°ÆÂÆö</button>
      </view>
    </view>
  </view>
</view> 